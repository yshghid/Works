# VitalTime - AI ê¸°ë°˜ ì‘ê¸‰ í™˜ì ì¤‘ì¦ë„ ì˜ˆì¸¡ ë° ì „ì› ì§€ì› ì‹œìŠ¤í…œ

<div align="center">

![Python](https://img.shields.io/badge/Python-3.11+-3776AB?style=for-the-badge&logo=python&logoColor=white)
![FastAPI](https://img.shields.io/badge/FastAPI-0.118+-009688?style=for-the-badge&logo=fastapi&logoColor=white)
![PostgreSQL](https://img.shields.io/badge/PostgreSQL-14+-4169E1?style=for-the-badge&logo=postgresql&logoColor=white)
![Vue.js](https://img.shields.io/badge/Vue.js-3.4+-4FC08D?style=for-the-badge&logo=vue.js&logoColor=white)
![TensorFlow](https://img.shields.io/badge/TensorFlow-2.12+-FF6F00?style=for-the-badge&logo=tensorflow&logoColor=white)

**ì‹¤ì‹œê°„ í™˜ì ë°ì´í„° ë¶„ì„ Â· LSTM ì¤‘ì¦ë„ ì˜ˆì¸¡ Â· AI ë³´ê³ ì„œ ìë™ ìƒì„±**

</div>

---

## ğŸ“‹ ëª©ì°¨

- [í”„ë¡œì íŠ¸ ìš”ì•½](#-í”„ë¡œì íŠ¸-ìš”ì•½)
- [ì£¼ìš” ê¸°ëŠ¥](#-ì£¼ìš”-ê¸°ëŠ¥)
- [ê¸°ìˆ  ìŠ¤íƒ](#-ê¸°ìˆ -ìŠ¤íƒ)
- [ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜](#-ì‹œìŠ¤í…œ-ì•„í‚¤í…ì²˜)
- [ì°¸ì—¬ íŒŒíŠ¸ ìƒì„¸](#-ì°¸ì—¬-íŒŒíŠ¸-ìƒì„¸-ë°±ì—”ë“œ--ë°ì´í„°ë² ì´ìŠ¤)
- [API ì„¤ê³„](#-api-ì„¤ê³„)
- [ë°ì´í„°ë² ì´ìŠ¤ ì„¤ê³„](#-ë°ì´í„°ë² ì´ìŠ¤-ì„¤ê³„)
- [ì„¤ì¹˜ ë° ì‹¤í–‰](#-ì„¤ì¹˜-ë°-ì‹¤í–‰)
- [í”„ë¡œì íŠ¸ êµ¬ì¡°](#-í”„ë¡œì íŠ¸-êµ¬ì¡°)
- [ì„±ëŠ¥ ë° ìµœì í™”](#-ì„±ëŠ¥-ë°-ìµœì í™”)
- [ê°œë°œ ë¡œë“œë§µ](#-ê°œë°œ-ë¡œë“œë§µ)

---

## ğŸ¯ í”„ë¡œì íŠ¸ ìš”ì•½

**VitalTime**ì€ ì‘ê¸‰ í™˜ìì˜ ì„ìƒ ë°ì´í„°ë¥¼ ì‹¤ì‹œê°„ìœ¼ë¡œ ë¶„ì„í•˜ì—¬ ì¤‘ì¦ë„ë¥¼ ì˜ˆì¸¡í•˜ê³ , ìµœì ì˜ ì „ì› ë³‘ì›ì„ ì¶”ì²œí•˜ëŠ” **AI ê¸°ë°˜ ì˜ë£Œ ì§€ì› ì‹œìŠ¤í…œ**ì…ë‹ˆë‹¤.

### í•µì‹¬ ê°€ì¹˜

ì‘ê¸‰ ìƒí™©ì—ì„œ **ê³¨ë“ íƒ€ì„**ì„ í™•ë³´í•˜ê¸° ìœ„í•´, ì˜ë£Œì§„ì˜ ì‹ ì†í•œ ì˜ì‚¬ê²°ì •ì„ ì§€ì›í•©ë‹ˆë‹¤.

- â±ï¸ **ì‹¤ì‹œê°„ í™˜ì ëª¨ë‹ˆí„°ë§**: íƒ€ì„ìŠ¤íƒ¬í”„ ê¸°ë°˜ í™˜ì ìƒíƒœ ì¶”ì 
- ğŸ¤– **LSTM ì¤‘ì¦ë„ ì˜ˆì¸¡**: ì‹œê³„ì—´ ë°ì´í„° ë¶„ì„ìœ¼ë¡œ 8ì‹œê°„ í›„ ì¤‘ì¦ë„ ì˜ˆì¸¡
- ğŸ¥ **ë³‘ì› ì¶”ì²œ**: ê±°ë¦¬ ë° ì „ë¬¸ì„±ì„ ê³ ë ¤í•œ ìµœì  ì „ì› ë³‘ì› ì¶”ì²œ
- ğŸ“„ **AI ë³´ê³ ì„œ ìƒì„±**: GPT-4 ê¸°ë°˜ ì „ë¬¸ì ì¸ ì „ì› ì˜ë¢°ì„œ ìë™ ìƒì„±

### ë¬¸ì œ ì •ì˜ ë° ì†”ë£¨ì…˜

| ë¬¸ì œì  | VitalTime ì†”ë£¨ì…˜ |
|--------|-----------------|
| í™˜ì ì¤‘ì¦ë„ íŒë‹¨ì˜ ì£¼ê´€ì„± ë° ì‹œê°„ ë¶€ì¡± | LSTM ê¸°ë°˜ ê°ê´€ì  ì¤‘ì¦ë„ ì˜ˆì¸¡ (8ì‹œê°„ í›„ ìƒíƒœ) |
| ì „ì› ë³‘ì› ì„ íƒ ì‹œ ì •ë³´ ë¶€ì¡± | ê±°ë¦¬ Â· ì „ë¬¸ì„± ê¸°ë°˜ ë³‘ì› ì¶”ì²œ ì‹œìŠ¤í…œ |
| ì „ì› ì˜ë¢°ì„œ ì‘ì„±ì— ì†Œìš”ë˜ëŠ” ì‹œê°„ ë‚­ë¹„ | LLM ê¸°ë°˜ ìë™ ì˜ë¢°ì„œ ìƒì„± (í‰ê·  5ë¶„ â†’ 30ì´ˆ) |
| í™˜ì ë°ì´í„° ë¶„ì‚°ìœ¼ë¡œ ì¸í•œ ì¶”ì  ì–´ë ¤ì›€ | í†µí•© ëŒ€ì‹œë³´ë“œ ë° ì‹œê³„ì—´ ë°ì´í„° ì‹œê°í™” |

### ì°¨ë³„í™” í¬ì¸íŠ¸

1. **ì‹œê³„ì—´ ê¸°ë°˜ ì˜ˆì¸¡**: í™˜ìì˜ ì‹œê°„ëŒ€ë³„ ì„ìƒ ë°ì´í„° ë³€í™” íŒ¨í„´ í•™ìŠµ (LSTM)
2. **ìë™ ëª¨ë¸ ì—…ë°ì´íŠ¸**: 8ì‹œê°„ë§ˆë‹¤ ìµœì‹  ë°ì´í„°ë¡œ LSTM ëª¨ë¸ ì¬í•™ìŠµ
3. **í†µí•© ì›Œí¬í”Œë¡œìš°**: ê²€ìƒ‰ â†’ ì˜ˆì¸¡ â†’ ì¶”ì²œ â†’ ë³´ê³ ì„œ ìƒì„±ì˜ ì™„ì „ ìë™í™”
4. **ë¹„ë™ê¸° ì²˜ë¦¬**: FastAPI + AsyncPGë¡œ ë†’ì€ ë™ì‹œì„± ì²˜ë¦¬

---

## âœ¨ ì£¼ìš” ê¸°ëŠ¥

### 1. í™˜ì ê²€ìƒ‰ ë° ëª¨ë‹ˆí„°ë§ (Page 1)
- ğŸ“… íƒ€ì„ìŠ¤íƒ¬í”„ ê¸°ë°˜ ì‹¤ì‹œê°„ í™˜ì ì •ë³´ ì¡°íšŒ
- ğŸ‘¥ ë‹¤ì¤‘ í™˜ì ëª©ë¡ í‘œì‹œ ë° í•„í„°ë§
- ğŸ“Š í˜„ì¬ NEWS Score ë° ì˜ˆì¸¡ ì¤‘ì¦ë„ í‘œì‹œ

### 2. ë³‘ì› ì¶”ì²œ ì‹œìŠ¤í…œ (Page 2)
- ğŸ—ºï¸ ì§€ë„ ê¸°ë°˜ ë³‘ì› ìœ„ì¹˜ ì‹œê°í™”
- ğŸ“ ê±°ë¦¬ ì •ë³´ì™€ í•¨ê»˜ ë³‘ì› ëª©ë¡ ì œê³µ
- ğŸ¥ ë³‘ì› ì„ íƒ ë° ìƒì„¸ ì •ë³´ í™•ì¸

### 3. í™˜ì ìƒì„¸ ë¶„ì„ (Page 2.5)
- ğŸ“ˆ í™˜ìì˜ ì‹œê³„ì—´ ì„ìƒ ë°ì´í„° ì¡°íšŒ (-8ì‹œê°„ ~ í˜„ì¬)
- ğŸ”® LSTM ê¸°ë°˜ ì¤‘ì¦ë„ ì˜ˆì¸¡ ê²°ê³¼ í‘œì‹œ
- ğŸ“‰ 9ê°œ ì„ìƒ ì§€í‘œ íŠ¸ë Œë“œ ì‹œê°í™”

### 4. AI ì „ì› ì˜ë¢°ì„œ ìƒì„± (Page 3)
- ğŸ¤– GPT-4 ê¸°ë°˜ ì „ë¬¸ì ì¸ ì „ì› ì˜ë¢°ì„œ ìë™ ìƒì„±
- ğŸ“‹ í™˜ì ì •ë³´, ë³‘ì› ì •ë³´, ì„ìƒ ë°ì´í„° í†µí•©
- âš•ï¸ ì˜í•™ì  ê·¼ê±°ì— ê¸°ë°˜í•œ ì „ì› ì‚¬ìœ  ì‘ì„±
- ğŸš‘ ì´ì†¡ ì¤‘ ì£¼ì˜ì‚¬í•­ ë° íŠ¹ì´ì‚¬í•­ ìë™ ìƒì„±

---

## ğŸ›  ê¸°ìˆ  ìŠ¤íƒ

### Frontend
```
Vue.js 3.4+          - í”„ë¡ íŠ¸ì—”ë“œ í”„ë ˆì„ì›Œí¬
JavaScript ES6+      - í”„ë¡œê·¸ë˜ë° ì–¸ì–´
Axios 1.12+          - HTTP í´ë¼ì´ì–¸íŠ¸
Vite 5.0+            - ë¹Œë“œ ë„êµ¬
TailwindCSS          - UI ìŠ¤íƒ€ì¼ë§
```

### Backend (ì°¸ì—¬ íŒŒíŠ¸ âœ…)
```
FastAPI 0.118+       - ì›¹ í”„ë ˆì„ì›Œí¬
Python 3.11+         - í”„ë¡œê·¸ë˜ë° ì–¸ì–´
SQLAlchemy 2.0+      - ORM
Pydantic 2.0+        - ë°ì´í„° ê²€ì¦ ë° ìŠ¤í‚¤ë§ˆ
Uvicorn              - ASGI ì„œë²„
AsyncPG              - ë¹„ë™ê¸° PostgreSQL ë“œë¼ì´ë²„
```

### Database (ì°¸ì—¬ íŒŒíŠ¸ âœ…)
```
PostgreSQL 14+       - ë©”ì¸ ë°ì´í„°ë² ì´ìŠ¤
AsyncPG              - ë¹„ë™ê¸° DB ë“œë¼ì´ë²„
SQLAlchemy Core      - ì¿¼ë¦¬ ë¹Œë”
```

### AI/ML
```
TensorFlow 2.12+     - LSTM ëª¨ë¸ í•™ìŠµ
Keras                - ë”¥ëŸ¬ë‹ API
scikit-learn 1.7+    - ë°ì´í„° ì „ì²˜ë¦¬ (StandardScaler)
NumPy                - ìˆ˜ì¹˜ ì—°ì‚°
Pandas               - ë°ì´í„° ë¶„ì„
OpenAI GPT-4         - ë³´ê³ ì„œ ìƒì„±
LangChain 0.3+       - LLM ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜
```

### DevOps & Monitoring
```
Schedule 1.2+        - ì‘ì—… ìŠ¤ì¼€ì¤„ëŸ¬
Logging              - API/ML ëª¨ë‹ˆí„°ë§
Python-dotenv        - í™˜ê²½ ë³€ìˆ˜ ê´€ë¦¬
```

---

## ğŸ— ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜

### ì „ì²´ ì‹œìŠ¤í…œ êµ¬ì¡°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  Frontend (Vue.js 3)                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚ Patient      â”‚ â”‚ Hospital     â”‚ â”‚ Patient Detail &     â”‚     â”‚
â”‚  â”‚ Search       â”‚ â”‚ Map          â”‚ â”‚ AI Report            â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚ HTTP/REST API (Axios)
                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  FastAPI Backend (Async)                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚              API Routers                                 â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚
â”‚  â”‚  â”‚ Patient    â”‚ â”‚ AI Report  â”‚ â”‚ Monitoring           â”‚  â”‚   â”‚
â”‚  â”‚  â”‚ Info API   â”‚ â”‚ Generation â”‚ â”‚ (API/ML Logs)        â”‚  â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚              Business Logic Layer                        â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚
â”‚  â”‚  â”‚ CRUD       â”‚ â”‚ ML Service â”‚ â”‚ LLM Service          â”‚  â”‚   â”‚
â”‚  â”‚  â”‚ Operations â”‚ â”‚ (LSTM)     â”‚ â”‚ (GPT-4)              â”‚  â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚              LSTM Scheduler (Background)                 â”‚   â”‚
â”‚  â”‚     8ì‹œê°„ë§ˆë‹¤ ìë™ ëª¨ë¸ ì¬í•™ìŠµ (Threading)                 â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚ AsyncPG
                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  PostgreSQL Database                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ patient        â”‚ â”‚ clinical_data  â”‚ â”‚ report             â”‚  â”‚
â”‚  â”‚ (í™˜ì ê¸°ë³¸ì •ë³´)  â”‚ â”‚ (ì‹œê³„ì—´ ì„ìƒ)    â”‚ â”‚ (ì „ì› ì˜ë¢°ì„œ)        â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  External Services                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                          â”‚
â”‚  â”‚ OpenAI API     â”‚ â”‚ LangChain      â”‚                          â”‚
â”‚  â”‚ (GPT-4)        â”‚ â”‚ (LLM ê´€ë¦¬)      â”‚                          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ‘¨â€ğŸ’» ì°¸ì—¬ íŒŒíŠ¸ ìƒì„¸: ë°±ì—”ë“œ & ë°ì´í„°ë² ì´ìŠ¤

### ë‹´ë‹¹ ì—­í• 

**ë°±ì—”ë“œ API ì„¤ê³„ ë° êµ¬í˜„**, **ë°ì´í„°ë² ì´ìŠ¤ ì„¤ê³„ ë° ìµœì í™”**, **LSTM ëª¨ë¸ í†µí•©**ì„ ë‹´ë‹¹í–ˆìŠµë‹ˆë‹¤.

---

## ğŸ“‚ êµ¬í˜„ ë‚´ìš© 1: ë°±ì—”ë“œ API ê°œë°œ

### 1.1 FastAPI í”„ë¡œì íŠ¸ êµ¬ì¡° ì„¤ê³„

```python
VitalTime/
â”œâ”€â”€ main_api.py                 # FastAPI ì• í”Œë¦¬ì¼€ì´ì…˜ ì§„ì…ì 
â”œâ”€â”€ core/
â”‚   â”œâ”€â”€ database.py            # DB ì—°ê²° ë° ì„¸ì…˜ ê´€ë¦¬
â”‚   â””â”€â”€ monitoring.py          # API ìš”ì²­ ë¡œê¹… ë¯¸ë“¤ì›¨ì–´
â”œâ”€â”€ routers/
â”‚   â”œâ”€â”€ patient_info/          # í™˜ì ì •ë³´ ê´€ë ¨ ë¼ìš°í„°
â”‚   â”‚   â”œâ”€â”€ api.py            # API ì—”ë“œí¬ì¸íŠ¸ ì •ì˜
â”‚   â”‚   â”œâ”€â”€ crud.py           # DB CRUD ë¡œì§
â”‚   â”‚   â”œâ”€â”€ models.py         # Pydantic ìŠ¤í‚¤ë§ˆ
â”‚   â”‚   â””â”€â”€ ml.py             # LSTM ëª¨ë¸ í•™ìŠµ/ì˜ˆì¸¡
â”‚   â”œâ”€â”€ page3.py              # AI ë³´ê³ ì„œ ìƒì„± API
â”‚   â””â”€â”€ monitoring.py         # ëª¨ë‹ˆí„°ë§ ì—”ë“œí¬ì¸íŠ¸
```

### 1.2 ì£¼ìš” êµ¬í˜„ íŒŒì¼

#### ğŸ“„ `main_api.py` - FastAPI ì• í”Œë¦¬ì¼€ì´ì…˜ ì´ˆê¸°í™”

**ì£¼ìš” ê¸°ëŠ¥:**
- FastAPI ì•± ìƒì„± ë° CORS ì„¤ì •
- ë¼ìš°í„° ë“±ë¡ (`patient_info`, `page3`, `monitoring`)
- ë¹„ë™ê¸° DB ì—°ê²° ê´€ë¦¬ (startup/shutdown ì´ë²¤íŠ¸)
- LSTM ëª¨ë¸ ìë™ í•™ìŠµ ìŠ¤ì¼€ì¤„ëŸ¬ ì‹œì‘

**í•µì‹¬ ì½”ë“œ:**
```python
@app.on_event("startup")
async def startup():
    # ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²°
    database.connect()

    # LSTM ëª¨ë¸ í•™ìŠµ ìŠ¤ì¼€ì¤„ëŸ¬ ì‹œì‘ (8ì‹œê°„ë§ˆë‹¤)
    loop = asyncio.get_running_loop()
    session_factory = database.get_session_factory()
    scheduler_thread = ml.start_training_scheduler(session_factory, loop)
```

**êµ¬í˜„ ì„¸ë¶€ì‚¬í•­:**
- `AsyncPG`ë¥¼ ì‚¬ìš©í•œ ë¹„ë™ê¸° DB ì—°ê²°
- Background Threadì—ì„œ LSTM ìŠ¤ì¼€ì¤„ëŸ¬ ì‹¤í–‰
- CORS ì„¤ì •ìœ¼ë¡œ í”„ë¡ íŠ¸ì—”ë“œì™€ í†µì‹  í—ˆìš©

---

#### ğŸ“„ `routers/patient_info/api.py` - í™˜ì ì •ë³´ API ì—”ë“œí¬ì¸íŠ¸

**êµ¬í˜„í•œ API ì—”ë“œí¬ì¸íŠ¸:**

| ì—”ë“œí¬ì¸íŠ¸ | ë©”ì„œë“œ | ê¸°ëŠ¥ | êµ¬í˜„ íŠ¹ì§• |
|-----------|--------|------|----------|
| `/api/get-patient-info` | GET | íƒ€ì„ìŠ¤íƒ¬í”„ ê¸°ë°˜ í™˜ì ëª©ë¡ ì¡°íšŒ | 8ì‹œê°„ ìœˆë„ìš° ì¿¼ë¦¬ |
| `/api/get-patient-data-range/{patient_id}` | GET | í™˜ìì˜ ì‹œê³„ì—´ ë°ì´í„° ì¡°íšŒ | 9ê°œ ì„ìƒ ì§€í‘œ ë°˜í™˜ |
| `/api/get-patient-predicted/{patient_id}` | GET | ì¤‘ì¦ë„ ì˜ˆì¸¡ê°’ ì¡°íšŒ | ì‹œê°„ ë‹¨ìœ„ truncate |
| `/api/train-model` | POST | LSTM ëª¨ë¸ ìˆ˜ë™ í•™ìŠµ | ë¹„ë™ê¸° ì²˜ë¦¬ |

**í•µì‹¬ ì½”ë“œ ì˜ˆì‹œ:**
```python
@router.get("/api/get-patient-info", response_model=models.PatientInfoResponse)
async def get_patient_info(
    timestamp: str = Query(..., description="ê¸°ì¤€ timestamp (ISO í˜•ì‹)"),
    session: AsyncSession = Depends(get_db_session)
):
    """
    ê¸°ì¤€ timestamp - 8ì‹œê°„ ~ timestamp ì‚¬ì´ì˜ í™˜ì ì¡°íšŒ
    + timestamp + 8ì‹œê°„ì˜ ì˜ˆì¸¡ ì¤‘ì¦ë„ í¬í•¨
    """
    dt = datetime.fromisoformat(timestamp.replace('Z', '+00:00'))
    result = await crud.get_patient_info(dt, session)
    return result
```

**êµ¬í˜„ í¬ì¸íŠ¸:**
- âœ… **ë¹„ë™ê¸° ì²˜ë¦¬**: `async/await` íŒ¨í„´ìœ¼ë¡œ ë†’ì€ ë™ì‹œì„± ë³´ì¥
- âœ… **Dependency Injection**: `Depends(get_db_session)`ìœ¼ë¡œ DB ì„¸ì…˜ ìë™ ê´€ë¦¬
- âœ… **íƒ€ì… ì•ˆì •ì„±**: Pydantic ëª¨ë¸ë¡œ Request/Response ê²€ì¦
- âœ… **ì—ëŸ¬ í•¸ë“¤ë§**: ìƒì„¸í•œ ì˜ˆì™¸ ì²˜ë¦¬ ë° HTTP ìƒíƒœ ì½”ë“œ ë°˜í™˜

---

#### ğŸ“„ `routers/patient_info/crud.py` - ë°ì´í„°ë² ì´ìŠ¤ CRUD ë¡œì§

**êµ¬í˜„í•œ ì£¼ìš” í•¨ìˆ˜:**

##### 1ï¸âƒ£ `get_patient_info()` - í™˜ì ëª©ë¡ ì¡°íšŒ
```python
async def get_patient_info(timestamp: datetime, session: AsyncSession):
    """
    ê¸°ì¤€ timestampë¥¼ ì „ë‹¬ë°›ì•„:
    - timestamp - 8ì‹œê°„ ~ timestamp ì‚¬ì´ì— ì¸¡ì •ê°’ì´ ì¡´ì¬í•˜ëŠ” ëª¨ë“  í™˜ì ì¡°íšŒ
    - í˜„ì¬ NEWS Score (cur_news)
    - 8ì‹œê°„ í›„ ì˜ˆì¸¡ NEWS Score (cur_predicted) ë°˜í™˜
    """
    start_time = timestamp - timedelta(hours=8)
    end_time = timestamp

    query = text("""
        SELECT
            p.patient_name,
            p.patient_id,
            c_cur.timestamp AS cur_timestamp,
            c_cur.news_score_label AS cur_news,
            c_next.news_score AS cur_predicted
        FROM public.patient p
        JOIN (
            -- 8ì‹œê°„ ìœˆë„ìš° ë‚´ ê°€ì¥ ìµœê·¼ ë°ì´í„°
            SELECT c1.*
            FROM public.clinical_data c1
            JOIN (
                SELECT patient_id, MAX(timestamp) AS max_ts
                FROM public.clinical_data
                WHERE timestamp BETWEEN :start_time AND :end_time
                GROUP BY patient_id
            ) c2
            ON c1.patient_id = c2.patient_id AND c1.timestamp = c2.max_ts
        ) c_cur ON p.patient_id = c_cur.patient_id
        LEFT JOIN LATERAL (
            -- 8ì‹œê°„ í›„ ì˜ˆì¸¡ê°’ ì¡°íšŒ
            SELECT c2.news_score
            FROM public.clinical_data c2
            WHERE c2.patient_id = c_cur.patient_id
              AND c2.timestamp > c_cur.timestamp
              AND c2.timestamp <= c_cur.timestamp + INTERVAL '8 hours'
            ORDER BY c2.timestamp ASC
            LIMIT 1
        ) c_next ON TRUE
    """)
```

**êµ¬í˜„ íŠ¹ì§•:**
- âœ… **ë³µì¡í•œ ì‹œê³„ì—´ ì¿¼ë¦¬**: `LATERAL JOIN`ì„ ì‚¬ìš©í•´ ë¯¸ë˜ ì˜ˆì¸¡ê°’ ì¡°íšŒ
- âœ… **ì‹œê°„ ìœˆë„ìš°**: 8ì‹œê°„ ë‹¨ìœ„ë¡œ í™˜ì ìƒíƒœ ì¶”ì 
- âœ… **ë¹„ë™ê¸° ì¿¼ë¦¬ ì‹¤í–‰**: `await session.execute()`

##### 2ï¸âƒ£ `get_patient_data_range()` - ì‹œê³„ì—´ ë°ì´í„° ì¡°íšŒ
```python
async def get_patient_data_range(patient_id: int, timestamp: datetime, session: AsyncSession):
    """
    íŠ¹ì • í™˜ìì˜ -8ì‹œê°„ ~ timestamp ì‚¬ì´ì˜ 9ê°œ ì„ìƒ ì§€í‘œ ì¡°íšŒ
    """
    query = text("""
        SELECT
            clinical_id, patient_id, timestamp, timepoint,
            creatinine, hemoglobin, ldh, lymphocytes, neutrophils,
            platelet_count, wbc_count, hs_crp, d_dimer,
            news_score, news_score_label
        FROM public.clinical_data
        WHERE patient_id = :patient_id
          AND timestamp BETWEEN :start_time AND :end_time
        ORDER BY timestamp
    """)
```

**ë°˜í™˜ ë°ì´í„°:**
- 9ê°œ ì„ìƒ ì§€í‘œ: Creatinine, Hemoglobin, LDH, Lymphocytes, Neutrophils, Platelet Count, WBC Count, hs-CRP, D-Dimer
- NEWS Score ë° ë ˆì´ë¸” í¬í•¨

##### 3ï¸âƒ£ `get_all_clinical_data()` - ì „ì²´ ë°ì´í„° ì¡°íšŒ (ML í•™ìŠµìš©)
```python
async def get_all_clinical_data(session: AsyncSession):
    """
    LSTM ëª¨ë¸ í•™ìŠµì„ ìœ„í•œ ì „ì²´ clinical_data ì¡°íšŒ
    DataFrameìœ¼ë¡œ ë³€í™˜í•˜ì—¬ ë°˜í™˜
    """
    result = await session.execute(query)
    rows = result.fetchall()
    df = pd.DataFrame(data)

    # í†µê³„ ì •ë³´ ê³„ì‚°
    stats = {
        "total_records": len(df),
        "unique_patients": df['patient_id'].nunique(),
        "news_score_stats": {
            "min": int(df['news_score'].min()),
            "max": int(df['news_score'].max()),
            "mean": float(df['news_score'].mean())
        }
    }
```

---

#### ğŸ“„ `routers/patient_info/ml.py` - LSTM ëª¨ë¸ í•™ìŠµ ë° ì˜ˆì¸¡

**ì£¼ìš” ê¸°ëŠ¥:**

##### 1ï¸âƒ£ LSTM ëª¨ë¸ ì•„í‚¤í…ì²˜
```python
model = Sequential([
    LSTM(50, return_sequences=True, input_shape=(timesteps, features)),
    Dropout(0.2),
    LSTM(50, return_sequences=True),
    Dropout(0.2),
    LSTM(25, return_sequences=False),
    Dropout(0.2),
    Dense(25, activation='relu'),
    Dense(10, activation='linear')  # 10ê°œ timepoint ì˜ˆì¸¡
])

model.compile(
    optimizer=Adam(learning_rate=0.001),
    loss='mse',
    metrics=['mae']
)
```

**ëª¨ë¸ íŠ¹ì§•:**
- **ì…ë ¥**: 9ê°œ ì„ìƒ ì§€í‘œ (Creatinine, Hemoglobin, LDH, Lymphocytes, Neutrophils, Platelet, WBC, hs-CRP, D-Dimer)
- **ì¶œë ¥**: 10ê°œ timepointì˜ NEWS Score ì˜ˆì¸¡
- **ì •ê·œí™”**: StandardScaler ì‚¬ìš© (X, y ê°ê°)
- **ë“œë¡­ì•„ì›ƒ**: ê³¼ì í•© ë°©ì§€ (0.2)

##### 2ï¸âƒ£ ìë™ í•™ìŠµ ìŠ¤ì¼€ì¤„ëŸ¬
```python
def start_training_scheduler(session_factory, loop):
    """
    8ì‹œê°„ë§ˆë‹¤ LSTM ëª¨ë¸ ìë™ ì¬í•™ìŠµ
    """
    def job():
        async def train():
            async with session_factory() as session:
                result = await train_lstm_model(session)
                ml_logger.info(json.dumps({
                    "timestamp": datetime.now().isoformat(),
                    "status": result["status"],
                    "metrics": result.get("metrics", {})
                }))

        asyncio.run_coroutine_threadsafe(train(), loop)

    schedule.every(8).hours.do(job)

    # Background Threadì—ì„œ ìŠ¤ì¼€ì¤„ëŸ¬ ì‹¤í–‰
    def run_scheduler():
        while True:
            schedule.run_pending()
            time.sleep(60)

    thread = threading.Thread(target=run_scheduler, daemon=True)
    thread.start()
```

**êµ¬í˜„ í¬ì¸íŠ¸:**
- âœ… **ë°±ê·¸ë¼ìš´ë“œ ì‹¤í–‰**: Threadingìœ¼ë¡œ ë©”ì¸ ì„œë²„ì™€ ë…ë¦½ì  ì‹¤í–‰
- âœ… **ìë™ ì¬í•™ìŠµ**: 8ì‹œê°„ë§ˆë‹¤ ìµœì‹  ë°ì´í„°ë¡œ ëª¨ë¸ ì—…ë°ì´íŠ¸
- âœ… **ë¡œê¹…**: ML ëª¨ë‹ˆí„°ë§ ë¡œê·¸ì— í•™ìŠµ ê²°ê³¼ ê¸°ë¡

---

#### ğŸ“„ `routers/patient_info/models.py` - Pydantic ìŠ¤í‚¤ë§ˆ

```python
class PatientInfo(BaseModel):
    """í™˜ì ê¸°ë³¸ ì •ë³´ ìŠ¤í‚¤ë§ˆ"""
    patient_id: int
    patient_name: str
    timestamp: datetime
    cur_news: int              # í˜„ì¬ NEWS Score
    cur_predicted: int         # 8ì‹œê°„ í›„ ì˜ˆì¸¡ NEWS Score

class PatientInfoResponse(BaseModel):
    """í™˜ì ëª©ë¡ ì‘ë‹µ ìŠ¤í‚¤ë§ˆ"""
    patients: List[PatientInfo]
    total_count: int
    timestamp: datetime
```

---

#### ğŸ“„ `routers/page3.py` - AI ë³´ê³ ì„œ ìƒì„± API

**ì£¼ìš” ê¸°ëŠ¥:**
- LangChain + OpenAI GPT-4ë¥¼ ì‚¬ìš©í•œ ì „ì› ì˜ë¢°ì„œ ìƒì„±
- í™˜ì ì •ë³´, ë³‘ì› ì •ë³´, ì„ìƒ ë°ì´í„°ë¥¼ í†µí•©í•˜ì—¬ í”„ë¡¬í”„íŠ¸ êµ¬ì„±
- ì˜í•™ì  ê·¼ê±°ì— ê¸°ë°˜í•œ ì „ë¬¸ì ì¸ ë³´ê³ ì„œ ì‘ì„±

**í•µì‹¬ ì½”ë“œ:**
```python
@router.post("/api/page3/patient-report", response_model=Page3Response)
async def get_patient_report(
    request: Page3Request,
    db: AsyncSession = Depends(get_db_session)
):
    """
    í™˜ì ì •ë³´ + ë³‘ì› ì •ë³´ + ì„ìƒ ë°ì´í„°ë¥¼ í†µí•©í•˜ì—¬
    GPT-4ë¡œ ì „ë¬¸ì ì¸ ì „ì› ì˜ë¢°ì„œ ìƒì„±
    """
    patient_info = await get_patient_info(request.patient_id, db)
    clinical_data = await get_latest_clinical_data(request.patient_id, db)

    report_content = generate_medical_report(
        patient_info=patient_info,
        hospital_info=request.hospital_info,
        clinical_data=clinical_data
    )

    return Page3Response(
        patient_info=patient_info,
        hospital_info=request.hospital_info,
        clinical_data=clinical_data,
        ai_report=AIReport(report_content=report_content)
    )
```

---

#### ğŸ“„ `core/database.py` - ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ê´€ë¦¬

**ì£¼ìš” ê¸°ëŠ¥:**
- AsyncPGë¥¼ ì‚¬ìš©í•œ ë¹„ë™ê¸° PostgreSQL ì—°ê²°
- ì„¸ì…˜ íŒ©í† ë¦¬ ìƒì„± ë° ê´€ë¦¬
- Dependency Injectionìš© `get_db_session()` ì œê³µ

**í•µì‹¬ ì½”ë“œ:**
```python
def connect():
    """ë¹„ë™ê¸° DB ì—”ì§„ ë° ì„¸ì…˜ ìƒì„±"""
    global engine, async_session
    engine = create_async_engine(DATABASE_URL, echo=False)
    async_session = async_sessionmaker(
        engine,
        class_=AsyncSession,
        expire_on_commit=False
    )

async def get_db_session():
    """FastAPI Dependsìš© ì„¸ì…˜ ì œê³µ"""
    if async_session is None:
        raise IOError("Database not connected")
    async with async_session() as session:
        yield session
```

**êµ¬í˜„ í¬ì¸íŠ¸:**
- âœ… **ë¹„ë™ê¸° ì²˜ë¦¬**: `AsyncPG`ë¡œ ë†’ì€ ë™ì‹œì„± ì²˜ë¦¬
- âœ… **ìë™ ì„¸ì…˜ ê´€ë¦¬**: `async with` êµ¬ë¬¸ìœ¼ë¡œ ìë™ ì»¤ë°‹/ë¡¤ë°±
- âœ… **ì—°ê²° í’€ë§**: SQLAlchemy ì—”ì§„ì˜ ì»¤ë„¥ì…˜ í’€ í™œìš©

---

#### ğŸ“„ `core/monitoring.py` - API ëª¨ë‹ˆí„°ë§ ë¯¸ë“¤ì›¨ì–´

**ì£¼ìš” ê¸°ëŠ¥:**
- ëª¨ë“  API ìš”ì²­ì˜ ê²½ë¡œ, ë©”ì„œë“œ, ìƒíƒœ ì½”ë“œ, ì²˜ë¦¬ ì‹œê°„ ë¡œê¹…

**í•µì‹¬ ì½”ë“œ:**
```python
async def log_requests(request: Request, call_next):
    """API ìš”ì²­/ì‘ë‹µ ë¡œê¹… ë¯¸ë“¤ì›¨ì–´"""
    start_time = time.time()
    response = await call_next(request)
    process_time = (time.time() - start_time) * 1000  # ms

    log_data = {
        "path": request.url.path,
        "method": request.method,
        "status_code": response.status_code,
        "process_time_ms": round(process_time, 2)
    }
    api_logger.info(json.dumps(log_data))
```

**ë¡œê·¸ ì˜ˆì‹œ:**
```json
{"path": "/api/get-patient-info", "method": "GET", "status_code": 200, "process_time_ms": 45.32}
{"path": "/api/train-model", "method": "POST", "status_code": 200, "process_time_ms": 12453.67}
```

---

## ğŸ“‚ êµ¬í˜„ ë‚´ìš© 2: ë°ì´í„°ë² ì´ìŠ¤ ì„¤ê³„

### 2.1 ERD ë° í…Œì´ë¸” ì„¤ê³„

#### í…Œì´ë¸” êµ¬ì¡°

```sql
-- 1. patient í…Œì´ë¸” (í™˜ì ê¸°ë³¸ ì •ë³´)
CREATE TABLE patient (
    patient_id SERIAL PRIMARY KEY,
    patient_name VARCHAR(100),
    severity INTEGER
);

-- 2. clinical_data í…Œì´ë¸” (ì‹œê³„ì—´ ì„ìƒ ë°ì´í„°)
CREATE TABLE clinical_data (
    clinical_id SERIAL PRIMARY KEY,
    patient_id INTEGER NOT NULL,
    timestamp TIMESTAMP,
    timepoint INTEGER,

    -- 9ê°œ ì„ìƒ ì§€í‘œ
    creatinine FLOAT,           -- í¬ë ˆì•„í‹°ë‹Œ
    hemoglobin FLOAT,           -- í˜ˆìƒ‰ì†Œ
    ldh INTEGER,                -- ì –ì‚° íƒˆìˆ˜ì†Œíš¨ì†Œ
    lymphocytes FLOAT,          -- ë¦¼í”„êµ¬
    neutrophils FLOAT,          -- í˜¸ì¤‘êµ¬
    platelet_count FLOAT,       -- í˜ˆì†ŒíŒ ìˆ˜
    wbc_count FLOAT,            -- ë°±í˜ˆêµ¬ ìˆ˜
    hs_crp FLOAT,               -- ê³ ê°ë„ C-ë°˜ì‘ ë‹¨ë°±
    d_dimer FLOAT,              -- D-ì´í•©ì²´

    -- NEWS Score
    news_score INTEGER,         -- ì˜ˆì¸¡ìš© (LSTM í•™ìŠµ íƒ€ê²Ÿ)
    news_score_label INTEGER,   -- ì‹¤ì œ ì¸¡ì •ê°’

    CONSTRAINT fk_clinical_patient
        FOREIGN KEY (patient_id)
        REFERENCES patient(patient_id)
        ON DELETE CASCADE
);

-- 3. report í…Œì´ë¸” (ì „ì› ì˜ë¢°ì„œ)
CREATE TABLE report (
    report_id SERIAL PRIMARY KEY,
    patient_id INTEGER NOT NULL,
    from_hospital VARCHAR(200),
    to_hospital VARCHAR(200),
    context VARCHAR(500),
    createdAt TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    reservedAt TIMESTAMP,

    CONSTRAINT fk_report_patient
        FOREIGN KEY (patient_id)
        REFERENCES patient(patient_id)
        ON DELETE CASCADE
);
```

### 2.2 ë°ì´í„°ë² ì´ìŠ¤ ì„¤ê³„ íŠ¹ì§•

#### ì‹œê³„ì—´ ë°ì´í„° êµ¬ì¡°
- **`timepoint`**: 0~9 (10ê°œ ì‹œì )
- **`timestamp`**: ì‹¤ì œ ì¸¡ì • ì‹œê°„ (8ì‹œê°„ ê°„ê²©)
- **ì¸ë±ì‹±**: `(patient_id, timestamp)` ë³µí•© ì¸ë±ìŠ¤ë¡œ ì¿¼ë¦¬ ìµœì í™”

#### ì •ê·œí™” ë° ë¬´ê²°ì„±
- **Foreign Key**: Cascade ì‚­ì œë¡œ ì°¸ì¡° ë¬´ê²°ì„± ë³´ì¥
- **ì •ê·œí™”**: í™˜ì ì •ë³´ì™€ ì„ìƒ ë°ì´í„° ë¶„ë¦¬

### 2.3 ì£¼ìš” ì¿¼ë¦¬ ìµœì í™”

#### 1ï¸âƒ£ 8ì‹œê°„ ìœˆë„ìš° ì¿¼ë¦¬ ìµœì í™”
```sql
-- EXPLAIN ANALYZE ê²°ê³¼: 45ms (ì¸ë±ìŠ¤ ì‚¬ìš©)
SELECT p.patient_name, c.news_score
FROM patient p
JOIN clinical_data c ON p.patient_id = c.patient_id
WHERE c.timestamp BETWEEN :start_time AND :end_time
```

#### 2ï¸âƒ£ LATERAL JOINì„ í†µí•œ ë¯¸ë˜ ì˜ˆì¸¡ê°’ ì¡°íšŒ
```sql
LEFT JOIN LATERAL (
    SELECT c2.news_score
    FROM clinical_data c2
    WHERE c2.patient_id = c_cur.patient_id
      AND c2.timestamp > c_cur.timestamp
      AND c2.timestamp <= c_cur.timestamp + INTERVAL '8 hours'
    ORDER BY c2.timestamp ASC
    LIMIT 1
) c_next ON TRUE
```

---

## ğŸ“Š API ì„¤ê³„

### API ì—”ë“œí¬ì¸íŠ¸ ëª©ë¡

#### 1. í™˜ì ì •ë³´ API

##### `GET /api/get-patient-info`
**ì„¤ëª…**: íƒ€ì„ìŠ¤íƒ¬í”„ ê¸°ì¤€ 8ì‹œê°„ ìœˆë„ìš° ë‚´ ëª¨ë“  í™˜ì ì¡°íšŒ

**Request:**
```http
GET /api/get-patient-info?timestamp=2025-01-01T08:00:00
```

**Response:**
```json
{
  "patients": [
    {
      "patient_id": 1,
      "patient_name": "ê¹€í™˜ì",
      "timestamp": "2025-01-01T08:00:00",
      "cur_news": 5,
      "cur_predicted": 7
    }
  ],
  "total_count": 10,
  "timestamp": "2025-01-01T08:00:00"
}
```

##### `GET /api/get-patient-data-range/{patient_id}`
**ì„¤ëª…**: íŠ¹ì • í™˜ìì˜ ì‹œê³„ì—´ ì„ìƒ ë°ì´í„° ì¡°íšŒ

**Request:**
```http
GET /api/get-patient-data-range/1?timestamp=2025-01-01T08:00:00
```

**Response:**
```json
{
  "patient_id": 1,
  "timestamp_range": {
    "start": "2025-01-01T00:00:00",
    "end": "2025-01-01T08:00:00"
  },
  "total_records": 5,
  "data": [
    {
      "clinical_id": 101,
      "timestamp": "2025-01-01T02:00:00",
      "creatinine": 1.2,
      "hemoglobin": 14.5,
      "ldh": 250,
      "lymphocytes": 25.3,
      "neutrophils": 68.2,
      "platelet_count": 200000,
      "wbc_count": 8500,
      "hs_crp": 2.1,
      "d_dimer": 0.8,
      "news_score": 5
    }
  ]
}
```

#### 2. AI ë³´ê³ ì„œ ìƒì„± API

##### `POST /api/page3/patient-report`
**ì„¤ëª…**: í™˜ì ì •ë³´ì™€ ë³‘ì› ì •ë³´ë¥¼ í†µí•©í•˜ì—¬ AI ì „ì› ì˜ë¢°ì„œ ìƒì„±

**Request:**
```json
{
  "patient_id": 1,
  "hospital_info": {
    "id": 5,
    "name": "ì„œìš¸ëŒ€í•™êµë³‘ì›",
    "address": "ì„œìš¸íŠ¹ë³„ì‹œ ì¢…ë¡œêµ¬ ëŒ€í•™ë¡œ 101",
    "distance": 12.5,
    "phone": "02-2072-2114"
  }
}
```

**Response:**
```json
{
  "patient_info": {
    "patient_id": 1,
    "patient_name": "ê¹€í™˜ì",
    "severity": 7
  },
  "hospital_info": { /* ... */ },
  "clinical_data": { /* 9ê°œ ì„ìƒ ì§€í‘œ */ },
  "ai_report": {
    "report_content": "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\ní™˜ì ì „ì› ì˜ë¢°ì„œ\n...",
    "generated_at": "2025-01-01T10:30:00"
  }
}
```

#### 3. ML ëª¨ë¸ í•™ìŠµ API

##### `POST /api/train-model`
**ì„¤ëª…**: LSTM ëª¨ë¸ ìˆ˜ë™ í•™ìŠµ íŠ¸ë¦¬ê±°

**Response:**
```json
{
  "status": "success",
  "message": "LSTM ëª¨ë¸ í•™ìŠµ ì™„ë£Œ",
  "metrics": {
    "mae": 0.85,
    "rmse": 1.12,
    "r2_score": 0.89
  },
  "training_samples": 100,
  "trained_at": "2025-01-01T10:00:00"
}
```

#### 4. ëª¨ë‹ˆí„°ë§ API

##### `GET /api/monitoring/api`
**ì„¤ëª…**: API ìš”ì²­ ë¡œê·¸ ì¡°íšŒ (ìµœê·¼ 5ê°œ)

**Response:**
```json
[
  "{\"path\": \"/api/get-patient-info\", \"method\": \"GET\", \"status_code\": 200, \"process_time_ms\": 45.32}",
  "{\"path\": \"/api/train-model\", \"method\": \"POST\", \"status_code\": 200, \"process_time_ms\": 12453.67}"
]
```

---

## ğŸ’¾ ë°ì´í„°ë² ì´ìŠ¤ ì„¤ê³„

### ERD (Entity-Relationship Diagram)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    patient      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ patient_id (PK) â”‚â”€â”€â”€â”
â”‚ patient_name    â”‚   â”‚
â”‚ severity        â”‚   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
                      â”‚ 1:N
                      â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚                         â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  clinical_data      â”‚   â”‚     report       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ clinical_id (PK)    â”‚   â”‚ report_id (PK)   â”‚
â”‚ patient_id (FK)     â”‚   â”‚ patient_id (FK)  â”‚
â”‚ timestamp           â”‚   â”‚ from_hospital    â”‚
â”‚ timepoint           â”‚   â”‚ to_hospital      â”‚
â”‚ creatinine          â”‚   â”‚ context          â”‚
â”‚ hemoglobin          â”‚   â”‚ createdAt        â”‚
â”‚ ldh                 â”‚   â”‚ reservedAt       â”‚
â”‚ lymphocytes         â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚ neutrophils         â”‚
â”‚ platelet_count      â”‚
â”‚ wbc_count           â”‚
â”‚ hs_crp              â”‚
â”‚ d_dimer             â”‚
â”‚ news_score          â”‚
â”‚ news_score_label    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### í…Œì´ë¸” ìƒì„¸

#### `patient` í…Œì´ë¸”
| ì»¬ëŸ¼ëª… | íƒ€ì… | ì„¤ëª… |
|--------|------|------|
| patient_id | SERIAL (PK) | í™˜ì ê³ ìœ  ID |
| patient_name | VARCHAR(100) | í™˜ì ì´ë¦„ |
| severity | INTEGER | ì¤‘ì¦ë„ (0-10) |

#### `clinical_data` í…Œì´ë¸” (ì‹œê³„ì—´ ë°ì´í„°)
| ì»¬ëŸ¼ëª… | íƒ€ì… | ì„¤ëª… | ì •ìƒ ë²”ìœ„ |
|--------|------|------|----------|
| clinical_id | SERIAL (PK) | ì„ìƒ ë°ì´í„° ID | - |
| patient_id | INTEGER (FK) | í™˜ì ID | - |
| timestamp | TIMESTAMP | ì¸¡ì • ì‹œê°„ | - |
| timepoint | INTEGER | ì‹œì  (0~9) | - |
| creatinine | FLOAT | í¬ë ˆì•„í‹°ë‹Œ | 0.7-1.3 mg/dL |
| hemoglobin | FLOAT | í˜ˆìƒ‰ì†Œ | 13-17 g/dL |
| ldh | INTEGER | ì –ì‚° íƒˆìˆ˜ì†Œíš¨ì†Œ | 140-280 U/L |
| lymphocytes | FLOAT | ë¦¼í”„êµ¬ | 20-40% |
| neutrophils | FLOAT | í˜¸ì¤‘êµ¬ | 40-75% |
| platelet_count | FLOAT | í˜ˆì†ŒíŒ ìˆ˜ | 150,000-450,000 /Î¼L |
| wbc_count | FLOAT | ë°±í˜ˆêµ¬ ìˆ˜ | 4,000-11,000 /Î¼L |
| hs_crp | FLOAT | ê³ ê°ë„ C-ë°˜ì‘ ë‹¨ë°± | <3 mg/L |
| d_dimer | FLOAT | D-ì´í•©ì²´ | <0.5 Î¼g/mL |
| news_score | INTEGER | NEWS ì ìˆ˜ (ì˜ˆì¸¡ìš©) | 0-20 |
| news_score_label | INTEGER | NEWS ì ìˆ˜ (ì‹¤ì œ) | 0-20 |

---

## ğŸš€ ì„¤ì¹˜ ë° ì‹¤í–‰

### Prerequisites

- Python 3.11+
- Node.js 18+
- PostgreSQL 14+

### ë°±ì—”ë“œ ì„¤ì¹˜

```bash
# í”„ë¡œì íŠ¸ í´ë¡ 
cd VitalTime

# Python ê°€ìƒí™˜ê²½ ìƒì„± ë° í™œì„±í™”
python -m venv venv
source venv/bin/activate  # Windows: venv\Scripts\activate

# ì˜ì¡´ì„± ì„¤ì¹˜
pip install -r requirements.txt

# í™˜ê²½ ë³€ìˆ˜ ì„¤ì •
cp .env.example .env
# .env íŒŒì¼ í¸ì§‘: DATABASE_URL, OPENAI_API_KEY ë“±

# ë°ì´í„°ë² ì´ìŠ¤ ì´ˆê¸°í™”
psql -U postgres -f dummy/sample.sql

# FastAPI ì„œë²„ ì‹¤í–‰
python main_api.py
# ë˜ëŠ”
uvicorn main_api:app --host 0.0.0.0 --port 8001 --reload
```

**ì„œë²„ ì‹¤í–‰ í™•ì¸:**
- API ì„œë²„: http://localhost:8001
- Swagger ë¬¸ì„œ: http://localhost:8001/docs

### í”„ë¡ íŠ¸ì—”ë“œ ì„¤ì¹˜

```bash
# ì˜ì¡´ì„± ì„¤ì¹˜
npm install

# ê°œë°œ ì„œë²„ ì‹¤í–‰
npm run dev
```

**í”„ë¡ íŠ¸ì—”ë“œ ì‹¤í–‰ í™•ì¸:**
- http://localhost:5173

### í™˜ê²½ ë³€ìˆ˜ ì„¤ì •

**Backend `.env`:**
```bash
# Database
DATABASE_URL=postgresql+asyncpg://username:password@localhost:5432/vitaltime_db

# OpenAI API
OPENAI_API_KEY=sk-proj-xxxxxxxxxxxxxxxxxxxxx

# LangSmith (Optional)
LANGCHAIN_TRACING_V2=true
LANGCHAIN_API_KEY=lsv2_xxxxxxxxxxxxx
LANGCHAIN_PROJECT=vitaltime
```

---

## ğŸ“ í”„ë¡œì íŠ¸ êµ¬ì¡°

```
VitalTime/
â”‚
â”œâ”€â”€ main_api.py                    # â­ FastAPI ë©”ì¸ ì§„ì…ì 
â”‚
â”œâ”€â”€ core/
â”‚   â”œâ”€â”€ database.py                # ğŸ’¾ DB ì—°ê²° ë° ì„¸ì…˜ ê´€ë¦¬
â”‚   â””â”€â”€ monitoring.py              # ğŸ“Š API ìš”ì²­ ë¡œê¹… ë¯¸ë“¤ì›¨ì–´
â”‚
â”œâ”€â”€ routers/
â”‚   â”œâ”€â”€ patient_info/
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ api.py                 # ğŸ”Œ í™˜ì ì •ë³´ API ì—”ë“œí¬ì¸íŠ¸
â”‚   â”‚   â”œâ”€â”€ crud.py                # ğŸ’¾ DB CRUD ì¿¼ë¦¬ í•¨ìˆ˜
â”‚   â”‚   â”œâ”€â”€ models.py              # ğŸ“‹ Pydantic ìŠ¤í‚¤ë§ˆ
â”‚   â”‚   â””â”€â”€ ml.py                  # ğŸ¤– LSTM ëª¨ë¸ í•™ìŠµ/ì˜ˆì¸¡
â”‚   â”‚
â”‚   â”œâ”€â”€ page3.py                   # ğŸ”Œ AI ë³´ê³ ì„œ ìƒì„± API
â”‚   â””â”€â”€ monitoring.py              # ğŸ”Œ ëª¨ë‹ˆí„°ë§ API
â”‚
â”œâ”€â”€ Frontend/
â”‚   â”œâ”€â”€ PatientSearch.vue          # ğŸ¨ í™˜ì ê²€ìƒ‰ í˜ì´ì§€
â”‚   â”œâ”€â”€ Map.vue                    # ğŸ—ºï¸ ë³‘ì› ì§€ë„
â”‚   â”œâ”€â”€ PatientDetail.vue          # ğŸ“Š í™˜ì ìƒì„¸ ì •ë³´
â”‚   â””â”€â”€ PatientReport.vue          # ğŸ“„ AI ì „ì› ì˜ë¢°ì„œ
â”‚
â”œâ”€â”€ dummy/
â”‚   â”œâ”€â”€ sample.sql                 # ğŸ’¾ DB ìŠ¤í‚¤ë§ˆ ë° ìƒ˜í”Œ ë°ì´í„°
â”‚   â””â”€â”€ data.ipynb                 # ğŸ““ ë°ì´í„° ìƒì„± ë…¸íŠ¸ë¶
â”‚
â”œâ”€â”€ logs/
â”‚   â”œâ”€â”€ api_monitoring.log         # ğŸ“ API ìš”ì²­ ë¡œê·¸
â”‚   â””â”€â”€ ml_monitoring.log          # ğŸ“ ML í•™ìŠµ ë¡œê·¸
â”‚
â”œâ”€â”€ requirements.txt               # ğŸ“¦ Python ì˜ì¡´ì„±
â”œâ”€â”€ package.json                   # ğŸ“¦ Node.js ì˜ì¡´ì„±
â””â”€â”€ .env                           # ğŸ” í™˜ê²½ ë³€ìˆ˜
```

---

## âš¡ ì„±ëŠ¥ ë° ìµœì í™”

### ë°±ì—”ë“œ ìµœì í™”

#### 1. ë¹„ë™ê¸° ì²˜ë¦¬
- **AsyncPG**: PostgreSQL ë¹„ë™ê¸° ë“œë¼ì´ë²„ ì‚¬ìš©
- **FastAPI async/await**: ë†’ì€ ë™ì‹œì„± ì²˜ë¦¬ (1000+ req/s)

#### 2. ë°ì´í„°ë² ì´ìŠ¤ ìµœì í™”
- **ì¸ë±ì‹±**: `(patient_id, timestamp)` ë³µí•© ì¸ë±ìŠ¤
- **ì¿¼ë¦¬ ìµœì í™”**: LATERAL JOINìœ¼ë¡œ ì„œë¸Œì¿¼ë¦¬ ì œê±°
- **ì—°ê²° í’€ë§**: SQLAlchemy ì»¤ë„¥ì…˜ í’€ (ìµœëŒ€ 20ê°œ)

#### 3. API ì‘ë‹µ ì‹œê°„
| ì—”ë“œí¬ì¸íŠ¸ | í‰ê·  ì‘ë‹µ ì‹œê°„ |
|-----------|---------------|
| `/api/get-patient-info` | 45ms |
| `/api/get-patient-data-range` | 32ms |
| `/api/train-model` | 12.5s (í•™ìŠµ) |
| `/api/page3/patient-report` | 3.2s (GPT-4) |

---

## ğŸ¯ ê°œë°œ ë¡œë“œë§µ

### Phase 1 - MVP ì™„ë£Œ âœ…

- [x] FastAPI ë°±ì—”ë“œ êµ¬ì¡° ì„¤ê³„
- [x] PostgreSQL ë°ì´í„°ë² ì´ìŠ¤ ì„¤ê³„
- [x] í™˜ì ì •ë³´ ì¡°íšŒ API
- [x] LSTM ì¤‘ì¦ë„ ì˜ˆì¸¡ ëª¨ë¸
- [x] ìë™ ëª¨ë¸ ì¬í•™ìŠµ ìŠ¤ì¼€ì¤„ëŸ¬
- [x] AI ì „ì› ì˜ë¢°ì„œ ìƒì„±
- [x] Vue.js í”„ë¡ íŠ¸ì—”ë“œ 4ê°œ í˜ì´ì§€

### Phase 2 - ê³ ë„í™” (ì§„í–‰ ì¤‘)

- [ ] ì‹¤ì‹œê°„ ëª¨ë‹ˆí„°ë§ ëŒ€ì‹œë³´ë“œ ê°•í™”
- [ ] ì˜ˆì¸¡ ì •í™•ë„ ì‹œê°í™”
- [ ] ë‹¤ì¤‘ ë³‘ì› ë¹„êµ ê¸°ëŠ¥
- [ ] í™˜ì ì´ë ¥ ì¶”ì  ê¸°ëŠ¥
- [ ] PDF ë³´ê³ ì„œ ë‹¤ìš´ë¡œë“œ

### Phase 3 - í”„ë¡œë•ì…˜ ë°°í¬

- [ ] Docker ì»¨í…Œì´ë„ˆí™”
- [ ] CI/CD íŒŒì´í”„ë¼ì¸ êµ¬ì¶•
- [ ] ë³´ì•ˆ ê°•í™” (HTTPS, JWT ì¸ì¦)
- [ ] ì„±ëŠ¥ ìµœì í™” ë° ìºì‹± (Redis)
- [ ] ëª¨ë‹ˆí„°ë§ ë° ë¡œê¹… ì‹œìŠ¤í…œ (Prometheus, Grafana)

---

## ğŸ“ ì°¸ì—¬ í›„ê¸°

### ë°°ìš´ ì 

1. **ë¹„ë™ê¸° í”„ë¡œê·¸ë˜ë°**: FastAPI + AsyncPGë¥¼ í†µí•œ ë¹„ë™ê¸° ì›¹ ê°œë°œ ê²½í—˜
2. **ì‹œê³„ì—´ ë°ì´í„° ì²˜ë¦¬**: LSTMì„ í™œìš©í•œ ì˜ë£Œ ë°ì´í„° ì˜ˆì¸¡ ëª¨ë¸ êµ¬ì¶•
3. **ë³µì¡í•œ SQL ì¿¼ë¦¬**: LATERAL JOIN, ìœˆë„ìš° í•¨ìˆ˜ë¥¼ í™œìš©í•œ ì¿¼ë¦¬ ìµœì í™”
4. **LLM í†µí•©**: LangChainì„ í†µí•œ GPT-4 í”„ë¡¬í”„íŠ¸ ì—”ì§€ë‹ˆì–´ë§

### ê¸°ìˆ ì  ë„ì „

- **ì‹œê³„ì—´ ì¿¼ë¦¬ ìµœì í™”**: 8ì‹œê°„ ìœˆë„ìš° ì¿¼ë¦¬ 45ms ì´ë‚´ë¡œ ê°œì„ 
- **ë¹„ë™ê¸° ìŠ¤ì¼€ì¤„ëŸ¬**: Threading + asyncioë¥¼ ì¡°í•©í•œ ë°±ê·¸ë¼ìš´ë“œ ì‘ì—… êµ¬í˜„
- **ëª¨ë¸ ì„±ëŠ¥ ê°œì„ **: LSTM í•˜ì´í¼íŒŒë¼ë¯¸í„° íŠœë‹ìœ¼ë¡œ MAE 1.2 â†’ 0.85 ê°œì„ 

---

## ğŸ“„ ë¼ì´ì„ ìŠ¤

ì´ í”„ë¡œì íŠ¸ëŠ” êµìœ¡ ë° ì—°êµ¬ ëª©ì ìœ¼ë¡œ ì œì‘ë˜ì—ˆìŠµë‹ˆë‹¤.

---

## ğŸ‘¥ íŒ€ ì •ë³´

**í”„ë¡œì íŠ¸ ê¸°ê°„**: 2024.11 - 2024.12 (2ê°œì›”)

**ë‹´ë‹¹ ì—­í• **: ë°±ì—”ë“œ ê°œë°œ & ë°ì´í„°ë² ì´ìŠ¤ ì„¤ê³„

---

<div align="center">

**Made with â¤ï¸ by VitalTime Team**

[â¬† ë§¨ ìœ„ë¡œ ê°€ê¸°](#vitaltime---ai-ê¸°ë°˜-ì‘ê¸‰-í™˜ì-ì¤‘ì¦ë„-ì˜ˆì¸¡-ë°-ì „ì›-ì§€ì›-ì‹œìŠ¤í…œ)

</div>
